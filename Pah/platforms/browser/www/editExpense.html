<ons-page id="editExpense">
  <ons-toolbar id="toolbar" class="toolbar" modifier="transparent">
    <div class="left">
      <ons-back-button></ons-back-button>
    </div>
    <div class="center labelToolbar" id="titleExpenses">
      EDITAR GASTO
    </div>
  </ons-toolbar>

  <ons-card>
    <div class="content">
      <div style="text-align: center; margin-top: 16px;">
        <p>
          <ons-input
            onchange="changeTitlePreviewEdit()"
            onkeypress="this.onchange()"
            oninput="this.onchange()"
            id="newExpenseNameEdit"
            modifier="underbar"
            placeholder="NUEVO NOMBRE"
            type="text"
            style="display: block; margin: 16px 16px;"
          ></ons-input>
        </p>
      </div>

      <label class="iconExpenseLabel" style="margin-bottom: -20px;">SELECCIONA UN COLOR</label>

      <div style="text-align: center; margin-top: 16px;">
        <p>
          <ons-input
            onchange="loadIconsEdit()"
            onkeypress="this.onchange()"
            oninput="this.onchange()"
            id="newExpenseColorEdit"
            type="color"
            value="#ffffff"
            style="display: block; margin: 16px 16px; border-radius: 50%x;"
          ></ons-input>
        </p>
      </div>

      <ons-list style="background: none; margin-top: -25px;">
        <ons-list-item id="expandableListContainerEdit" expandable>
          <label class="iconExpenseLabel" style="margin-left: 50px;">
            SELECCIONA UN ICONO
          </label>
          <div class="expandable-content" id="expenseIconListOfIconsEdit"> 
            <!-- AQUI SE CARGAN LOS ICONOS PARA SELECCIONAR -->
          </div>
        </ons-list-item>
      </ons-list>

      <ons-button
      class="flatButton"
      style="margin-top: 16px;"
      onclick="hideAlertExpenseEdit()"
      >LISTO!</ons-button
    >
    <ons-button
      class="flatButtonLight"
      style="margin-top: 16px;"
      onclick="hideAlertExpenseEditNoChange()"
      >CANCELAR</ons-button
    >
    </div>
  </ons-card>

  <label class="cardHomeTitle">PREVISUALIZACIÓN</label>
  <ons-card>
    <div class="title expenseTitle" id="expensePrevTitleEdit" style="display: inline-block; margin-bottom: 16px;">
      NUEVO NOMBRE
    </div>
    <i class="expenseIcon" id="expensePrevIconEdit"></i>
  </ons-card>

  <script>
    document.addEventListener(
      "init",
      function (event) {
        if (event.target.matches("#editExpense")) {
          loadIconsEdit();
          let expenseNameEdit = sessionStorage.getItem("expenseNameEdit");
          document.getElementById("newExpenseNameEdit").value = expenseNameEdit;
          document.getElementById("expensePrevTitleEdit").innerHTML = expenseNameEdit;

          let expenseS = JSON.parse(localStorage.getItem("expenseStorage"));
          let expenseIcon, expenseColor;

          for(let i = 0; i < expenseS.length; i++) {
            if (expenseS[i].expenseName == expenseNameEdit) {
              expenseIcon = expenseS[i].iconName;
              expenseColor = expenseS[i].expenseColor;
            }
          }

          /* OBTENGO EL ICONO ACTUAL Y LO AÑADO*/
          let iconElement = document.getElementById("expensePrevIconEdit");
          iconElement.className = '';
          iconElement.classList.add("expenseIcon");
          iconElement.classList.add(expenseIcon);
          // Añado el color
          iconElement.style.cssText = `--expenseIconColorPrev: ${expenseColor}`;

        }
      },
      false
    );
  </script>
</ons-page>

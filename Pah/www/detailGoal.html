<ons-page id="detailGoal">
  <ons-toolbar id="toolbar" class="toolbar" modifier="transparent">
    <ons-back-button></ons-back-button>

    <div class="center labelToolbar" id="titleDetailGoal">
      Monitor para jugar a 144 FPS
    </div>
  </ons-toolbar>
  <div id="goalDetailContainer"></div>

  <ons-alert-dialog id="my-alert-dialog" modifier="material">
    <div style="text-align: center; margin-top: 16px;">
      <div class="alert-dialog-title">Modificar meta</div>
    </div>

    <div class="alert-dialog-content">
      <div style="text-align: center; margin-top: 16px;">
        <p>
          <ons-input
            id="editGoalName"
            modifier="underbar"
            placeholder="NOMBRE DE LA META"
            type="text"
            style="display: block; margin: 16px 16px;"
          ></ons-input>

          <ons-input
            id="editGoalDescription"
            modifier="underbar"
            placeholder="DESCRIPCIÓN"
            type="text"
            style="display: block; margin: 16px 16px;"
          ></ons-input>

          <ons-input
            id="editGoalMoney"
            modifier="underbar"
            placeholder="DINERO NECESARIO"
            type="number"
            style="display: block; margin: 16px 16px;"
          ></ons-input>

          <ons-input
            id="editActualGoalMoney"
            modifier="underbar"
            placeholder="DINERO ACTUAL"
            type="number"
            style="display: block; margin: 16px 16px;"
          ></ons-input>

          <ons-input
            id="editGoalDate"
            modifier="underbar"
            placeholder="FECHA META"
            type="date"
            style="display: block; margin: 16px 16px;"
          ></ons-input>
        </p>
      </div>
    </div>

    <div class="alert-dialog-footer">
      <ons-alert-dialog-button onclick="hideAlertNoChange()"
        >Cancelar</ons-alert-dialog-button
      >
      <ons-alert-dialog-button onclick="hideAlertDialog()"
        >Listo!</ons-alert-dialog-button
      >
    </div>
  </ons-alert-dialog>

  <script>
    document.addEventListener(
      "init",
      function (event) {
        if (event.target.matches("#detailGoal")) {
          document.getElementById("titleDetailGoal").innerHTML = "";

          let retrievedGoal = sessionStorage.getItem("sessionFindGoal");
          let parseGoal = JSON.parse(retrievedGoal);

          let gName = parseGoal.name;
          let gDescription = parseGoal.description;
          let gAMoney = parseGoal.actualMoney;
          let gMoney = parseGoal.goalMoney;
          let gDate = parseGoal.date;

          document.getElementById("titleDetailGoal").innerHTML = gName;

          let goalsView = document.getElementById("goalDetailContainer");
          goalsView.innerHTML = "";

          /*
       TODO 
        - CALCULAR EL PORCENTAJE
        - CALCULAR BIEN LAS FECHAS
       */
          goalsView.innerHTML += `<ons-card>
              <div class="title detailTitle">
                ${gName}
              </div>
              <div class="content detailInfo">
                <p>
                  DESCRIPCIÓN: ${gDescription}
                </p>
              </div>
            </ons-card>
        
            <ons-card>
              <div class="title percentDetailTitle">
                50%
              </div>

              <div id="progressbar" class="percentBar">
                <div></div>
              </div>

              <div class="content">
                <label class="moneyDetailGoal">
                  $ ${gAMoney} de $ ${gMoney}
                </label>
                <label class="moneyDetailGoal">
                  ${gDate}
                </label>
                <ons-button class="flatButton" style="margin-top: 16px;" onclick="deleteGoal('${gName}')">
                  ELIMINAR
                </ons-button>
              </div>
            </ons-card>

            <ons-button class="flatButtonLight" style="margin-bottom: 16px;" onclick="editGoal('${gName}')">
              EDITAR
            </ons-button>`;
        }
      },
      false
    );
  </script>
</ons-page>
